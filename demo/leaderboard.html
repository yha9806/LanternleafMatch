<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ç¯ç¬¼å¶å­æ¶ˆæ¶ˆä¹ - æ’è¡Œæ¦œ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #2d5a27 0%, #1a3518 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #fff;
    }
    .container {
      width: 100%;
      max-width: 540px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 20px;
    }
    .header {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px 0;
    }
    .back-btn {
      width: 40px;
      height: 40px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .title {
      font-size: 24px;
      font-weight: bold;
      color: #FFD700;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin: 20px 0;
    }
    .tab {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 25px;
      background: rgba(255,255,255,0.1);
      color: #fff;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }
    .tab.active {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #333;
    }
    .my-rank {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,165,0,0.1));
      border: 2px solid #FFD700;
      border-radius: 16px;
      margin-bottom: 20px;
    }
    .my-rank .rank {
      font-size: 28px;
      font-weight: bold;
      color: #FFD700;
      min-width: 50px;
      text-align: center;
    }
    .my-rank .avatar {
      font-size: 40px;
    }
    .my-rank .info {
      flex: 1;
    }
    .my-rank .name {
      font-size: 16px;
      font-weight: bold;
    }
    .my-rank .score {
      font-size: 14px;
      opacity: 0.8;
      margin-top: 4px;
    }
    .leaderboard-list {
      flex: 1;
      overflow-y: auto;
    }
    .rank-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 15px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      margin-bottom: 8px;
      transition: background 0.2s;
    }
    .rank-item:hover {
      background: rgba(255,255,255,0.1);
    }
    .rank-item.top1 { background: rgba(255,215,0,0.2); }
    .rank-item.top2 { background: rgba(192,192,192,0.15); }
    .rank-item.top3 { background: rgba(205,127,50,0.15); }
    .rank-item .rank {
      font-size: 18px;
      font-weight: bold;
      min-width: 35px;
      text-align: center;
    }
    .rank-item.top1 .rank { color: #FFD700; }
    .rank-item.top2 .rank { color: #C0C0C0; }
    .rank-item.top3 .rank { color: #CD7F32; }
    .rank-item .medal {
      font-size: 24px;
      min-width: 35px;
      text-align: center;
    }
    .rank-item .avatar {
      font-size: 32px;
    }
    .rank-item .info {
      flex: 1;
    }
    .rank-item .name {
      font-size: 14px;
      font-weight: bold;
    }
    .rank-item .score {
      font-size: 12px;
      opacity: 0.7;
      margin-top: 2px;
    }
    .rank-item .stars {
      font-size: 16px;
      color: #FFD700;
      font-weight: bold;
    }
    .empty-state {
      text-align: center;
      padding: 40px;
      opacity: 0.6;
    }
    .empty-state .icon {
      font-size: 48px;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <button class="back-btn" onclick="goBack()">â†</button>
      <h1 class="title">æ’è¡Œæ¦œ</h1>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="switchTab('total')" id="tabTotal">æ€»æ˜Ÿæ¦œ</button>
      <button class="tab" onclick="switchTab('weekly')" id="tabWeekly">å‘¨æ˜Ÿæ¦œ</button>
      <button class="tab" onclick="switchTab('friends')" id="tabFriends">å¥½å‹æ¦œ</button>
    </div>

    <div class="my-rank" id="myRank">
      <div class="rank">#--</div>
      <div class="avatar">ğŸ™‚</div>
      <div class="info">
        <div class="name">æˆ‘</div>
        <div class="score">0 é¢—æ˜Ÿ</div>
      </div>
    </div>

    <div class="leaderboard-list" id="leaderboardList">
      <!-- åŠ¨æ€ç”Ÿæˆ -->
    </div>
  </div>

<script>
// ============================================
// æ’è¡Œæ¦œç³»ç»Ÿ
// ============================================

// æ¨¡æ‹Ÿç©å®¶æ•°æ®
const MOCK_PLAYERS = [
  { name: 'æ˜Ÿè¾°å¤§æµ·', avatar: 'ğŸ±', stars: 450 },
  { name: 'æ£®æ—å®ˆæŠ¤è€…', avatar: 'ğŸ¶', stars: 420 },
  { name: 'å¶å­æ”¶è—å®¶', avatar: 'ğŸ¦Š', stars: 385 },
  { name: 'æ¶ˆæ¶ˆä¹å¤§å¸ˆ', avatar: 'ğŸ°', stars: 350 },
  { name: 'æ©¡æœçŒäºº', avatar: 'ğŸ»', stars: 320 },
  { name: 'æ²»æ„ˆç³»ç©å®¶', avatar: 'ğŸ¼', stars: 290 },
  { name: 'æ‚ é—²æ—¶å…‰', avatar: 'ğŸ¨', stars: 265 },
  { name: 'å°ç¡®å¹¸', avatar: 'ğŸ¯', stars: 240 },
  { name: 'åˆåé˜³å…‰', avatar: 'ğŸ¦', stars: 210 },
  { name: 'èŠ±å›­ç²¾çµ', avatar: 'ğŸ¸', stars: 185 }
];

const MOCK_WEEKLY = [
  { name: 'å‘¨å† äº‰éœ¸', avatar: 'ğŸ¦‹', stars: 85 },
  { name: 'è¿ç»­ç™»é¡¶', avatar: 'ğŸ', stars: 72 },
  { name: 'å‘¨æœ«æˆ˜å£«', avatar: 'ğŸ', stars: 65 },
  { name: 'ç¨³æ­¥å‰è¿›', avatar: 'ğŸ¦', stars: 58 },
  { name: 'æ–°æ˜Ÿå´›èµ·', avatar: 'ğŸ¢', stars: 50 }
];

let currentTab = 'total';
let myStars = 0;

function loadMyStars() {
  try {
    const saved = localStorage.getItem('lanternleaf_player_progress');
    if (saved) {
      const data = JSON.parse(saved);
      myStars = data.totalStars || 0;
    }
  } catch (e) {
    console.log('Failed to load stars:', e);
  }
}

function switchTab(tab) {
  currentTab = tab;

  // æ›´æ–°æ ‡ç­¾æ ·å¼
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');

  renderLeaderboard();
}

function renderLeaderboard() {
  const list = document.getElementById('leaderboardList');
  const myRankEl = document.getElementById('myRank');

  let players = [];
  let myRank = '--';

  if (currentTab === 'total') {
    players = [...MOCK_PLAYERS];
    // æ’å…¥è‡ªå·±
    const meIndex = players.findIndex(p => p.stars < myStars);
    if (meIndex >= 0) {
      myRank = meIndex + 1;
    } else {
      myRank = players.length + 1;
    }
  } else if (currentTab === 'weekly') {
    players = [...MOCK_WEEKLY];
    // å‡è®¾æœ¬å‘¨è·å¾—çš„æ˜Ÿæ˜Ÿ
    const weeklyStars = Math.floor(myStars * 0.2);
    const meIndex = players.findIndex(p => p.stars < weeklyStars);
    myRank = meIndex >= 0 ? meIndex + 1 : players.length + 1;
  } else {
    // å¥½å‹æ¦œ - æ˜¾ç¤ºç©ºçŠ¶æ€
    list.innerHTML = `
      <div class="empty-state">
        <div class="icon">ğŸ‘¥</div>
        <p>é‚€è¯·å¥½å‹ä¸€èµ·ç©å§!</p>
        <p style="font-size:12px;margin-top:10px;">æ•¬è¯·æœŸå¾…ç¤¾äº¤åŠŸèƒ½</p>
      </div>
    `;
    myRankEl.querySelector('.rank').textContent = '#--';
    return;
  }

  // æ›´æ–°æˆ‘çš„æ’å
  myRankEl.querySelector('.rank').textContent = '#' + myRank;
  myRankEl.querySelector('.score').textContent = myStars + ' é¢—æ˜Ÿ';

  // æ¸²æŸ“åˆ—è¡¨
  const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];

  list.innerHTML = players.map((player, index) => {
    const rank = index + 1;
    const topClass = rank <= 3 ? 'top' + rank : '';

    return `
      <div class="rank-item ${topClass}">
        ${rank <= 3
          ? `<span class="medal">${medals[rank-1]}</span>`
          : `<span class="rank">${rank}</span>`
        }
        <span class="avatar">${player.avatar}</span>
        <div class="info">
          <div class="name">${player.name}</div>
          <div class="score">${currentTab === 'weekly' ? 'æœ¬å‘¨' : 'æ€»è®¡'} ${player.stars} é¢—æ˜Ÿ</div>
        </div>
        <span class="stars">${player.stars} â­</span>
      </div>
    `;
  }).join('');
}

function goBack() {
  window.location.href = 'menu.html';
}

// åˆå§‹åŒ–
loadMyStars();
renderLeaderboard();
</script>
</body>
</html>
